{% extends "students/base.html" %}
{% block content %}
<div>
   <div class="jumbotron text-center text-white jumbotron-image shadow" style="background-image: url(https://images.unsplash.com/photo-1552152974-19b9caf99137?fit=crop&w=1350&q=80);">
  </br>
    <h1> Registrar Portal</h1>
  </div>
</div>

<div class="container" style="text-align: center;">
	  <div class="p-3 mb-2 bg-dark text-white">Registration</div>
</div></br>

<div class="container">
				<div class="card-deck">
					<div class="card">
					  <div class="card-body">
						<h5 class="card-title" style="text-align: center;">Select Wizard ID:</h5>
            <div class="container text-center">
                <select id="wizid">
                {% if request.session.studentid %}
                  <option selected= {{ request.session.studentid }}>{{ request.session.studentid }}</option>
                {% else %}
                  <option selected="">Select Wizard ID</option>
                {% endif %}
                  {% for wizid in students %}
                    <option value="{{ wizid.studentid }}"> {{ wizid.studentid }}</option>
                  {% endfor %}
                </select>
              </div>
					  </div>
					 </div>
				
					<div class="card">
					  <div class="card-body">
						<h5 class="card-title" style="text-align: center;">Select Course:</h5>
            <div class="container text-center">
                  <select id="course">
                  {% if request.session.coursename %}
                    <option selected= {{ request.session.coursename }}>{{ request.session.coursename }}</option>
                  {% else %}
                    <option selected="">Select Course</option>
                  {% endif %}
                    {% for course in regcourse %}
                      <option value="{{ course.coursename }}"> {{ course.coursename }}</option>
                    {% endfor %}
                  </select>
                <button type="button" id="btn" class="btn btn-primary">Register</button>
                </div>
					  </div>
					 </div>
				</div> </br> 

<div class="container" style="text-align: center;">
	  <div class="p-3 mb-2 bg-light"> <b> Wizard Course Schedule </b> </div>
</div>

<div class="container">
  <table class="table table-striped table-dark">
    <thead>
      <th>Wizard ID</th>
      <th>Course ID</th>
      <th>Course Name</th>
      <th>Instructor Name</th>
    </thead>
    <tbody>
      {% for row in registrar %}
      <tr>
        <td>{{ row.studentid }}</td>
        <td>{{ row.courseid }}</td>
        <td>{{ row.coursename }}</td>
        <td>{{ row.instructorname }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function() {
    $("#btn").click(function() {
      $.ajax({
        url: "{% url 'registrar' %}",
        data: {
          wizid: $("#wizid").val(),
          course: $("#course").val(),
        },
        success: function(data) {
          if(data == 'Success') {
            window.location = "{% url 'registrar' %}"
          }
          else if(data == 'Course1') {
            alert("You have registered the maximum of 3 classes.")
          }
          else if(data == 'Course2') {
            alert("You have previously registered in the class.")
          }
        }
      });
    });
  $("#wizid").change(function() {
    $.ajax({
      url: "{% url 'registrar' %}",
      data: {
        wizid:$("#wizid").val()
      },
      success: function(data) {
        window.location = "{% url 'registrar' %}"
      }
    });
  });
});
</script>
{% endblock %}